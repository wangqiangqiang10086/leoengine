{"version":3,"sources":["game/node_modules/browser-pack/_prelude.js","game/game/game.js","game/game/role/DemoRole.js"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import DemoRole from './role/DemoRole';\r\n\r\nfunction ImagePreloader(images, basePath = '') {\r\n    return new Promise((resolve, reject) => {\r\n        let total = images.length,\r\n            success = 0,\r\n            failure = 0,\r\n            abort = 0,\r\n            totalImages = [];\r\n\r\n        let i = 0, oImage, imgPath;\r\n        for (; i < total; i++) {\r\n            oImage = new Image();\r\n            imgPath = images[i];\r\n\r\n            oImage.onload = onload;\r\n            oImage.onerror = onerror;\r\n            oImage.onabort = onabort;\r\n            oImage.src = basePath + imgPath;\r\n            totalImages.push(oImage);\r\n        }\r\n\r\n        function onload() {\r\n            success++;\r\n            checkLoad();\r\n        }\r\n        function onerror() {\r\n            failure++;\r\n            checkLoad();\r\n        }\r\n        function onabort() {\r\n            abort++;\r\n            checkLoad();\r\n        }\r\n\r\n        function checkLoad() {\r\n            if (total - success - failure - abort == 0) {\r\n                resolve({ total: total, success: success, failure: failure, abort: abort, totalImages: totalImages });\r\n            }\r\n        }\r\n    });\r\n}\r\n(() => {\r\n    const CG_DIC_KEYCODE = {\r\n        UP: 87,\r\n        RIGHT: 68,\r\n        DOWN: 83,\r\n        LEFT: 65,\r\n        ARROW_UP: 38,\r\n        ARROW_RIGHT: 39,\r\n        ARROW_DOWN: 40,\r\n        ARROW_LEFT: 37,\r\n        SPACE: 32,\r\n        KEYJ: 74,\r\n        KEYK: 75\r\n    };\r\n\r\n    let imgsMagicSrc = [];\r\n    for (let i = 0; i < 10; i++) {\r\n        imgsMagicSrc.push(`magic/2/0-${i}.png`);\r\n    }\r\n    new ImagePreloader(imgsMagicSrc, 'images/').then((res) => {\r\n        let imgMagicSource = res.totalImages;\r\n\r\n        let imgsSrc = [];\r\n        for (let i = 0; i < 8; i++) {\r\n            for (let j = 0; j < 23; j++) {\r\n                imgsSrc.push(`role/body/0/${i}-${j}.png`);\r\n            }\r\n        }\r\n\r\n        new ImagePreloader(imgsSrc, 'images/').then((res) => {\r\n            let imgSources = res.totalImages;\r\n            let elementFps = document.getElementById(\"fps\");\r\n\r\n            let stage = new leoEngine.display.CGStage('canvas', true, {\r\n                onFps: function (fps) {\r\n                    elementFps.innerText = \"fps:\" + fps;\r\n                }\r\n            });\r\n\r\n            let role0 = new DemoRole(100, 100, 100, 200);\r\n            role0.initFrames(imgSources);\r\n\r\n            stage.addChild(role0);\r\n\r\n            let seqMagic = leoEngine.display.CGSequenceFrame.createFromImgs(imgMagicSource);\r\n            seqMagic.play();\r\n            stage.addChild(seqMagic);\r\n\r\n            stage.render();\r\n\r\n            let keyDirectionStack = [];\r\n            let KeyDirectionArray = [CG_DIC_KEYCODE.UP, CG_DIC_KEYCODE.ARROW_UP, CG_DIC_KEYCODE.RIGHT, CG_DIC_KEYCODE.ARROW_RIGHT, CG_DIC_KEYCODE.DOWN, CG_DIC_KEYCODE.ARROW_DOWN, CG_DIC_KEYCODE.LEFT, CG_DIC_KEYCODE.ARROW_LEFT];\r\n            document.addEventListener('keydown', (e) => {\r\n                //console.log(e)\r\n                let keyCode = e.keyCode;\r\n                if (KeyDirectionArray.indexOf(keyCode) > -1) {\r\n                    let lastKeyCode = _.last(keyDirectionStack);\r\n                    if (!e.repeat) {\r\n                        switch (keyCode) {\r\n                            case CG_DIC_KEYCODE.UP:\r\n                            case CG_DIC_KEYCODE.ARROW_UP:\r\n                                //pushKeyDirectionStack(0);\r\n                                break;\r\n                            case CG_DIC_KEYCODE.RIGHT:\r\n                            case CG_DIC_KEYCODE.ARROW_RIGHT:\r\n                                pushKeyDirectionStack(2);\r\n                                break;\r\n                            case CG_DIC_KEYCODE.DOWN:\r\n                            case CG_DIC_KEYCODE.ARROW_DOWN:\r\n                                //pushKeyDirectionStack(4);\r\n                                break;\r\n                            case CG_DIC_KEYCODE.LEFT:\r\n                            case CG_DIC_KEYCODE.ARROW_LEFT:\r\n                                pushKeyDirectionStack(6);\r\n                                break;\r\n                        }\r\n                    }\r\n\r\n                    actionRun();\r\n\r\n                } else {\r\n                    if (!e.repeat) {\r\n                        switch (keyCode) {\r\n                            case CG_DIC_KEYCODE.KEYJ:\r\n                                role0.action_attack0();\r\n                                break;\r\n                            case CG_DIC_KEYCODE.KEYK:\r\n                                //role0.action_attack1();\r\n                                role0.Jump();\r\n\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                function pushKeyDirectionStack(code) {\r\n                    if (keyDirectionStack.indexOf(code) == -1) {\r\n                        keyDirectionStack.push(code);\r\n                    }\r\n                }\r\n\r\n                function actionRun() {\r\n                    let [code0, code1] = _.takeRight(keyDirectionStack, 2).sort();\r\n\r\n                    if (code0 == undefined) return;\r\n\r\n                    if (code1 == undefined) {\r\n                        role0.action_run(code0);\r\n                    } else {\r\n                        let dCode = code0 + \"\" + code1;\r\n                        switch (dCode) {\r\n                            case \"02\":\r\n                                role0.action_run(1);\r\n                                break;\r\n                            case \"24\":\r\n                                role0.action_run(3);\r\n                                break;\r\n                            case \"46\":\r\n                                role0.action_run(5);\r\n                                break;\r\n                            case \"06\":\r\n                                role0.action_run(7);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n            });\r\n            document.addEventListener('keyup', (e) => {\r\n                //console.log(e)\r\n                let keyCode = e.keyCode;\r\n                let directionCode = null;\r\n\r\n                switch (keyCode) {\r\n                    case CG_DIC_KEYCODE.UP:\r\n                    case CG_DIC_KEYCODE.ARROW_UP:\r\n                        directionCode = 0;\r\n                        break;\r\n                    case CG_DIC_KEYCODE.RIGHT:\r\n                    case CG_DIC_KEYCODE.ARROW_RIGHT:\r\n                        directionCode = 2;\r\n                        break;\r\n                    case CG_DIC_KEYCODE.DOWN:\r\n                    case CG_DIC_KEYCODE.ARROW_DOWN:\r\n                        directionCode = 4;\r\n                        break;\r\n                    case CG_DIC_KEYCODE.LEFT:\r\n                    case CG_DIC_KEYCODE.ARROW_LEFT:\r\n                        directionCode = 6;\r\n                        break;\r\n                }\r\n\r\n                if (directionCode != null) {\r\n                    _.pull(keyDirectionStack, directionCode);\r\n                    if (keyDirectionStack.length == 0) {\r\n                        role0.action_stand(directionCode);\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n    });\r\n})();\r\n\r\n\r\n","class DemoRole extends leoEngine.CGSprite {\r\n    constructor(width = 0, height = 0, x = 0, y = 0, index = 0, visible = true) {\r\n        super(width, height, x, y, index, visible);\r\n        this._sequenceContainer = {};\r\n        this._currentSeq = null;\r\n        this._currentDirectionCode = 0;\r\n        this._currentAction = \"stand\";\r\n        this._onActionDo = false;\r\n        this._currentVX = 5;\r\n        this._montionObj = leoEngine.physics.MontionObject();\r\n        this._onJump = false;\r\n    }\r\n\r\n    initFrames(imgs) {\r\n        for (let i = 0; i < 8; i++) {\r\n            this._sequenceContainer[\"stand\" + i] = CGSequenceFrame.createFromImgs(imgs.slice((0 + (23 * i)), (3 + (23 * i))));\r\n            this._sequenceContainer[\"run\" + i] = CGSequenceFrame.createFromImgs(imgs.slice((3 + (23 * i)), (9 + (23 * i))));\r\n            this._sequenceContainer[\"attack0-\" + i] = CGSequenceFrame.createFromImgs(imgs.slice((9 + (23 * i)), (13 + (23 * i))));\r\n            this._sequenceContainer[\"attack1-\" + i] = CGSequenceFrame.createFromImgs(imgs.slice((13 + (23 * i)), (20 + (23 * i))));\r\n            this._sequenceContainer[\"fall\" + i] = CGSequenceFrame.createFromImgs(imgs.slice((20 + (23 * i)), (23 + (23 * i))));\r\n        }\r\n        this.action_stand(2);\r\n    }\r\n\r\n    action_stand(directionCode) {\r\n        this.action_go(\"stand\", directionCode);\r\n    }\r\n\r\n    action_run(directionCode) {\r\n        this.action_go(\"run\", directionCode);\r\n    }\r\n\r\n    action_attack0(directionCode = null) {\r\n        this.action_do(\"attack0-\", directionCode);\r\n    }\r\n\r\n    action_attack1(directionCode = null) {\r\n        this.action_do(\"attack1-\", directionCode);\r\n    }\r\n\r\n    action_fall(directionCode = null) {\r\n        this.action_do(\"fall\", directionCode);\r\n    }\r\n\r\n    action_go(action, directionCode) {\r\n        if (this._onActionDo || (action == this._currentAction && directionCode == this._currentDirectionCode)) return;\r\n\r\n        if (this._currentSeq) this._currentSeq.removeEventListener(\"loopend\");\r\n        this._currentAction = action;\r\n        this._currentDirectionCode = directionCode;\r\n        this._currentSeq = this._sequenceContainer[action + directionCode];\r\n    }\r\n\r\n    action_do(action, directionCode) {\r\n        let tmpDirectionCode = directionCode || this._currentDirectionCode;\r\n        if (this._onActionDo || (action == this._currentAction && tmpDirectionCode == this._currentDirectionCode)) return;\r\n\r\n        this._onActionDo = true;\r\n\r\n        if (this._currentSeq) this._currentSeq.removeEventListener(\"loopend\");\r\n        this._currentAction = action;\r\n        this._currentDirectionCode = tmpDirectionCode;\r\n        this._currentSeq = this._sequenceContainer[action + tmpDirectionCode];\r\n        this._currentSeq.addEventListener('loopend', (seq) => {\r\n            this._onActionDo = false;\r\n            this.action_stand(tmpDirectionCode);\r\n        });\r\n        this._currentSeq.gotoAndPlay(0, false);\r\n    }\r\n\r\n    Jump(speed){\r\n        if(this._onJump) return;\r\n\r\n        this._onJump = true;\r\n        this._montionObj.setVY(-10);\r\n    }\r\n\r\n    renderSelf(selfCtx, offsetTime) {\r\n        if (this._currentAction == \"run\") {\r\n            switch (this._currentDirectionCode) {\r\n                case 2:\r\n                    this._montionObj.setVX = 5;\r\n                    break;\r\n                case 6:\r\n                    this._montionObj.setVX = -5;\r\n                    break;\r\n            }\r\n        } \r\n\r\n        var dObj = this._montionObj.update(offsetTime);\r\n        this.x += dObj.dx;\r\n        this.y += dObj.dy;\r\n        //console.log(dObj.dy);\r\n\r\n        if (this._onJump && this.y >= 540) {\r\n            this._onJump = false;\r\n            this.y = 540;\r\n            this._montionObj.setVY(0);\r\n            this._montionObj.setAY(0);\r\n        }\r\n\r\n        this._currentSeq.render(selfCtx, offsetTime);\r\n    }\r\n\r\n    dispose() {\r\n        this._currentSeq = null;\r\n        this._sequenceContainer = null;\r\n        super.dispose();\r\n    }\r\n}\r\n\r\nexport default DemoRole;\r\n\r\n\r\n\r\n"]}